<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>หวย Simulator</title>

<style>
    body {
        background:#f7d3f2;
        font-family:'Sarabun', sans-serif;
        padding:20px;
    }
    .box {
        width:100%;
        max-width:500px;
        margin:auto;
        background:#fff;
        padding:20px;
        border-radius:15px;
        box-shadow:0 5px 20px rgba(0,0,0,0.15);
    }
    h2 {
        text-align:center;
        color:#c449d5;
        margin-bottom:20px;
    }
    textarea {
        width:100%;
        height:110px;
        padding:12px;
        border-radius:10px;
        border:1px solid #aaa;
        font-size:16px;
        resize:none;
    }
    input {
        width:100%;
        padding:12px;
        border-radius:10px;
        border:1px solid #ccc;
        font-size:16px;
    }
    .row { display:flex; gap:10px; margin:10px 0; }

    button {
        padding:12px 16px;
        font-size:16px;
        border-radius:10px;
        border:none;
        cursor:pointer;
        font-weight:bold;
    }

    /* ปิด focus ของปุ่ม */
    button:focus {
        outline: none !important;
    }

    .btn-rev { background:#ffe06c; }
    .btn-add { background:#ff44c7; color:white; }

    .bill-box {
        margin-top:20px;
        background:#ffe7f8;
        padding:15px;
        border-radius:15px;
    }
    .bill {
        background:white;
        padding:12px;
        border-radius:12px;
        margin-bottom:12px;
        font-size:17px;
        display:flex;
        justify-content:space-between;
    }
    .del-btn {
        color:red;
        font-size:22px;
        cursor:pointer;
    }
    .total-all {
        text-align:center;
        font-size:22px;
        margin-top:20px;
        font-weight:bold;
    }
</style>
</head>

<body>

<div class="box">

    <h2>หวย Simulator Demo</h2>

    <!-- ช่องใส่เลข -->
    <textarea id="numbers" placeholder="ใส่เลข เช่น 46 64 69 96"></textarea>

    <!-- ปุ่มกลับเลข -->
    <button class="btn-rev" onclick="reverseNumbers()">กลับเลข</button>

    <!-- ราคาบน ล่าง -->
    <div class="row">
        <input id="top" type="number" placeholder="ราคา บน">
        <input id="bottom" type="number" placeholder="ราคา ล่าง">
    </div>

    <!-- เพิ่มบิล -->
    <button class="btn-add" onclick="addBill()">+ เพิ่มบิล</button>

    <!-- รายการบิล -->
    <div class="bill-box" id="billList"></div>

    <!-- รวมทั้งหมด -->
    <div id="totalAll" class="total-all">รวมทั้งหมด: 0 บาท</div>

</div>


<script>

let bills = [];

/* ----------------- ฟังก์ชันล้างข้อความขยะ ---------------- */
function cleanInput(raw) {
    let arr = raw.match(/\b\d{2}\b/g);
    return arr ? arr.join(" ") : "";
}

/* ตัดข้อความขยะโดยอัตโนมัติทุกครั้งที่พิมพ์หรือวาง */
document.getElementById("numbers").addEventListener("input", function(){
    let cleaned = cleanInput(this.value);
    this.value = cleaned;
});

/* ------------------- กลับเลข ---------------------- */
function reverseNumbers() {
    let raw = document.getElementById("numbers").value;

    let arr = raw.match(/\b\d{2}\b/g) || [];

    if(arr.length === 0){
        alert("ไม่มีเลขให้กลับ");
        return;
    }

    let reversedList = [];

    arr.forEach(num => {
        reversedList.push(num[1] + num[0]);
    });

    document.getElementById("numbers").value = arr.join(" ") + " " + reversedList.join(" ");
}

/* ------------------- เพิ่มบิล ---------------------- */
function addBill() {

    let raw = document.getElementById("numbers").value;
    let arr = raw.match(/\b\d{2}\b/g) || [];

    if (arr.length === 0) return alert("ไม่พบเลข 2 หลัก");

    let t = Number(document.getElementById("top").value || 0);
    let b = Number(document.getElementById("bottom").value || 0);

    let count = arr.length;

    let sumTop = count * t;
    let sumBottom = count * b;
    let sumBill = sumTop + sumBottom;

    bills.push({
        nums: arr,
        top: t,
        bottom: b,
        total: sumBill
    });

    renderBills();
}

/* ------------------- ลบ ---------------------- */
function delBill(i) {
    bills.splice(i,1);
    renderBills();
}

/* ------------------- แสดงบิล ---------------------- */
function renderBills() {

    let html = "";
    let totalAll = 0;

    bills.forEach((b,i)=>{

        totalAll += b.total;

        html += `
            <div class="bill">
                <div>
                    ${b.nums.join(" ")}<br>
                    บน ${b.top} × ${b.nums.length} = ${b.top * b.nums.length}<br>
                    ล่าง ${b.bottom} × ${b.nums.length} = ${b.bottom * b.nums.length}<br>
                    <b>รวมบิล: ${b.total} บาท</b>
                </div>
                <div class="del-btn" onclick="delBill(${i})">×</div>
            </div>
        `;
    });

    document.getElementById("billList").innerHTML = html;
    document.getElementById("totalAll").innerHTML = `รวมทั้งหมด: ${totalAll} บาท`;
}

</script>

</body>
</html>
