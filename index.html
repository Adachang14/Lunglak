<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>หวย Simulator</title>

<style>
    body{
        background:#f7d3f2;
        font-family:'Sarabun',sans-serif;
        padding:20px;
    }
    .box{
        width:100%;
        max-width:500px;
        margin:auto;
        background:#fff;
        padding:20px;
        border-radius:15px;
        box-shadow:0 5px 20px rgba(0,0,0,0.15);
    }
    h2{
        text-align:center;
        color:#c449d5;
        margin-bottom:20px;
    }

    /* MODE BUTTONS */
    .mode-row{
        display:flex;
        gap:10px;
        margin-bottom:15px;
    }
    .mode-btn{
        background:#ffe9a8;
        border:none;
        padding:10px 18px;
        border-radius:8px;
        cursor:pointer;
        font-weight:bold;
    }
    .mode-btn.active{
        background:#ffb700;
        color:white;
    }

    /* INPUT 1 */
    input[type="text"]{
        width:100%;
        padding:12px;
        border-radius:10px;
        border:1px solid #aaa;
        font-size:16px;
        transition:0.2s;
    }
    .highlight{
        box-shadow:0 0 10px #ff44c7;
        border-color:#ff44c7 !important;
    }

    /* NUMBER PILLS */
    .numbers-container{
        min-height:50px;
        padding:10px;
        border-radius:10px;
        border:1px solid #ddd;
        background:#fffafc;
        display:flex;
        flex-wrap:wrap;
        gap:6px;
        margin-top:4px;
    }
    .num-pill{
        background:#1e6bff;
        color:#fff;
        padding:4px 8px;
        border-radius:8px;
        font-size:13px;
        font-weight:bold;
        border:none;
        cursor:pointer;
    }
    .num-pill-error{
        background:#e02626;
        color:#fff;
        padding:4px 8px;
        border-radius:8px;
        font-size:13px;
        font-weight:bold;
        border:none;
        cursor:pointer;
    }

    .row{display:flex; gap:10px; margin:10px 0;}

    input[type="number"]{
        width:100%;
        padding:12px;
        border-radius:10px;
        border:1px solid #ccc;
        font-size:16px;
    }

    button{
        padding:12px 16px;
        font-size:16px;
        border-radius:10px;
        border:none;
        cursor:pointer;
        font-weight:bold;
    }
    .btn-rev{background:#ffe06c;}
    .btn-clear{background:#ffb3c1;}
    .btn-add{background:#ff44c7; color:white;}

    /* BILL UI */
    .bill-box{
        margin-top:20px;
        background:#ffe7f8;
        padding:15px;
        border-radius:15px;
    }
    .bill{
        background:white;
        padding:15px;
        border-radius:12px;
        margin-bottom:15px;
        display:flex;
        justify-content:space-between;
        border:1px solid #ddd;
    }
    .bill-left{
        max-width:260px;
        width:260px;
        font-size:14px;
    }
    .bill-title{
        font-weight:bold;
        font-size:17px;
        margin-bottom:5px;
        color:#333;
    }
    .bill-price{
        font-size:13px;
        color:#777;
    }
    .bill-multiply{
        font-size:13px;
        font-weight:bold;
        margin-bottom:8px;
    }
    .bill-nums{
        background:#f8f8f8;
        padding:8px;
        border-radius:10px;
        border:1px solid #ddd;
        line-height:1.4;
        font-size:12px;
        max-width:250px;
        word-break:break-word;
        white-space:normal;
    }
    .bill-total{
        font-size:14px;
        font-weight:bold;
        color:#d7006a;
    }
    .del-btn{
        font-size:20px;
        color:red;
        cursor:pointer;
    }

    .total-all{
        margin-top:20px;
        text-align:center;
        font-size:22px;
        font-weight:bold;
    }
</style>
</head>

<body>

<div class="box">

    <h2>หวย Simulator</h2>

    <!-- MODE -->
    <div class="mode-row">
        <button class="mode-btn active" id="btn2" onclick="switchMode('2')">2 ตัว</button>
        <button class="mode-btn" id="btn3" onclick="switchMode('3')">3 ตัว</button>
    </div>

    <!-- INPUT 1 -->
    <input id="inputNums" type="text" placeholder="วางเลขที่นี่ เช่น 12 54 23 หรือ 640 405 056">

    <!-- RESULT PILLS -->
    <div id="numbersContainer" class="numbers-container"></div>

    <div class="row">
        <button class="btn-rev" onclick="reverseNumbers()">กลับเลข</button>
        <button class="btn-clear" onclick="clearNumbers()">ล้างเลข</button>
    </div>

    <div class="row">
        <input id="top" type="number" placeholder="บน">
        <input id="bottom" type="number" placeholder="ล่าง">
    </div>

    <button class="btn-add" onclick="addBillAndReset()">+ เพิ่มบิล</button>

    <div id="billList" class="bill-box"></div>
    <div id="totalAll" class="total-all">รวมทั้งหมด: 0 บาท</div>

</div>

<script>
let mode = "2";        // 2 หรือ 3
let nums = [];         // เฉพาะเลขดี (ฟ้า)
let errors = [];       // เลขผิด (แดง)
let bills = [];

const input = document.getElementById("inputNums");
const box = document.getElementById("numbersContainer");

/* เปลี่ยนโหมด */
function switchMode(m){
    mode = m;
    document.querySelectorAll(".mode-btn").forEach(btn=>btn.classList.remove("active"));
    document.getElementById("btn"+m).classList.add("active");
    clearNumbers();
}

/* แสดงผลปุ่ม */
function render(){
    box.innerHTML = "";

    nums.forEach((n,i)=>{
        let b = document.createElement("button");
        b.className = "num-pill";
        b.textContent = n;
        b.onclick = ()=>{ nums.splice(i,1); render(); };
        box.appendChild(b);
    });

    errors.forEach((n,i)=>{
        let b = document.createElement("button");
        b.className = "num-pill-error";
        b.textContent = n;
        b.onclick = ()=>{ errors.splice(i,1); render(); };
        box.appendChild(b);
    });
}

/* ดึงเลขจากช่องเดียว */
input.addEventListener("input",()=>{
    let raw = input.value.trim();
    if(raw==="") return;

    // ดึงเฉพาะคำที่เป็นตัวเลขล้วน
    let tokens = raw.match(/\b\d+\b/g) || [];

    let good=[], bad=[];

    tokens.forEach(t=>{
        if(mode==="2"){
            if(t.length===2) good.push(t);
            else bad.push(t);
        }
        if(mode==="3"){
            if(t.length===3) good.push(t);
            else bad.push(t);
        }
    });

    nums = nums.concat(good);
    errors = errors.concat(bad);

    input.value = "";
    render();
});

/* กลับเลขเฉพาะสีน้ำเงิน */
function reverseNumbers(){
    if(nums.length===0) return;

    let newList = [...nums];

    nums.forEach(n=>{
        if(mode==="2"){
            let r = n[1] + n[0];
            if(!newList.includes(r)) newList.push(r);
        }
        if(mode==="3"){
            let a=n[0], b=n[1], c=n[2];
            let perms=[
                a+b+c, a+c+b, b+a+c,
                b+c+a, c+a+b, c+b+a
            ];
            [...new Set(perms)].forEach(p=>{
                if(!newList.includes(p)) newList.push(p);
            });
        }
    });

    nums = newList;
    render();
}

/* ล้างเลข */
function clearNumbers(){
    nums=[];
    errors=[];
    render();
    input.value="";
    document.getElementById("top").value="";
    document.getElementById("bottom").value="";
    input.focus();
}

/* เพิ่มบิล */
function addBill(){
    if(nums.length===0) return false;

    let t = Number(document.getElementById("top").value||0);
    let b = Number(document.getElementById("bottom").value||0);

    let total = nums.length * (t+b);

    bills.push({
        nums:[...nums],
        top:t,
        bottom:b,
        total:total,
        mode:mode
    });

    renderBills();
    return true;
}

function addBillAndReset(){
    if(!addBill()) return;
    clearNumbers();
}

/* ลบบิล */
function deleteBill(i){
    bills.splice(i,1);
    renderBills();
}

/* แสดงบิล */
function renderBills(){
    let html="";
    let all=0;

    bills.forEach((b,i)=>{
        all+=b.total;

        html += `
        <div class="bill">
            <div class="bill-left">
                <div class="bill-title">${b.mode==="2"?"2 ตัว":"3 ตัว"}</div>
                <div class="bill-price">บน × ล่าง</div>
                <div class="bill-multiply">${b.top} × ${b.bottom}</div>
                <div class="bill-nums">${b.nums.join(" ")}</div>
                <div class="bill-total">รวมบิล: ${b.total} บาท</div>
            </div>
            <div class="del-btn" onclick="deleteBill(${i})">×</div>
        </div>`;
    });

    document.getElementById("billList").innerHTML = html;
    document.getElementById("totalAll").innerHTML = "รวมทั้งหมด: "+all+" บาท";
}
</script>

</body>
</html>
