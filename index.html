<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>‡∏´‡∏ß‡∏¢ Simulator</title>

<style>
    body {
        background:#f7d3f2;
        font-family:'Sarabun', sans-serif;
        padding:20px;
    }
    .box {
        width:100%;
        max-width:500px;
        margin:auto;
        background:#fff;
        padding:20px;
        border-radius:15px;
        box-shadow:0 5px 20px rgba(0,0,0,0.15);
    }
    h2 {
        text-align:center;
        color:#c449d5;
        margin-bottom:20px;
    }

    /* ‡∏õ‡∏∏‡πà‡∏°‡πÇ‡∏´‡∏°‡∏î */
    .mode-row {
        display:flex;
        gap:10px;
        margin-bottom:15px;
    }
    .mode-btn {
        background:#ffe9a8;
        border:none;
        padding:10px 18px;
        border-radius:8px;
        cursor:pointer;
        font-weight:bold;
    }
    .mode-btn.active {
        background:#ffb700;
        color:white;
    }

    /* ‡∏ä‡πà‡∏≠‡∏á input */
    input[type="text"] {
        width:100%;
        padding:12px;
        border-radius:10px;
        border:1px solid #aaa;
        font-size:16px;
        transition:0.2s;
    }
    .highlight {
        box-shadow:0 0 10px #ff44c7;
        border-color:#ff44c7 !important;
    }

    /* Pill ‡πÄ‡∏•‡∏Ç */
    .numbers-container {
        min-height:50px;
        padding:10px;
        border-radius:10px;
        border:1px solid #ddd;
        background:#fffafc;
        display:flex;
        flex-wrap:wrap;
        gap:6px;
        margin-top:4px;
    }
    .num-pill {
        background:#1e6bff;
        color:#fff;
        padding:6px 10px;
        border-radius:8px;
        font-size:15px;
        font-weight:bold;
        border:none;
        cursor:pointer;
    }

    .row { display:flex; gap:10px; margin:10px 0; }

    input[type="number"] {
        width:100%;
        padding:12px;
        border-radius:10px;
        border:1px solid #ccc;
        font-size:16px;
    }

    /* ‡∏õ‡∏∏‡πà‡∏° */
    button {
        padding:12px 16px;
        font-size:16px;
        border-radius:10px;
        border:none;
        cursor:pointer;
        font-weight:bold;
    }
    .btn-rev  { background:#ffe06c; }
    .btn-clear{ background:#ffb3c1; }
    .btn-add  { background:#ff44c7; color:white; }

    /* ‡∏ö‡∏¥‡∏• */
    .bill-box {
        margin-top:20px;
        background:#ffe7f8;
        padding:15px;
        border-radius:15px;
    }
    .bill {
        background:white;
        padding:15px;
        border-radius:12px;
        margin-bottom:15px;
        display:flex;
        justify-content:space-between;
        border:1px solid #ddd;
    }
    .bill-left {
        width:85%;
        font-size:16px;
    }
    .bill-title {
        font-weight:bold;
        font-size:17px;
        margin-bottom:5px;
        color:#333;
    }
    .bill-price {
        color:#777;
        font-size:14px;
    }
    .bill-multiply {
        font-weight:bold;
        margin-bottom:8px;
    }
    .bill-nums {
        background:#f8f8f8;
        padding:10px;
        border-radius:10px;
        border:1px solid #ddd;
        line-height:1.7;
        word-break:break-all;
        font-size:15px;
        margin-bottom:8px;
    }
    .bill-total {
        font-weight:bold;
        color:#d7006a;
    }
    .del-btn {
        font-size:22px;
        color:red;
        cursor:pointer;
        user-select:none;
    }

    .total-all {
        text-align:center;
        font-size:22px;
        margin-top:20px;
        font-weight:bold;
    }

    .label {
        font-size:14px;
        margin:5px 0 3px;
        color:#555;
    }
</style>
</head>

<body>

<div class="box">

    <h2>‡∏´‡∏ß‡∏¢ Simulator Demo</h2>

    <!-- ‡∏õ‡∏∏‡πà‡∏°‡πÇ‡∏´‡∏°‡∏î -->
    <div class="mode-row">
        <button class="mode-btn active" id="btn2d" onclick="switchMode('2d')">2 ‡∏ï‡∏±‡∏ß</button>
        <button class="mode-btn" id="btn3d" onclick="switchMode('3d')">3 ‡∏ï‡∏±‡∏ß</button>
        <button class="mode-btn" id="btn19" onclick="switchMode('19')">19 ‡∏õ‡∏£‡∏∞‡∏ï‡∏π</button>
        <button class="mode-btn" id="btnRun" onclick="switchMode('run')">‡πÄ‡∏•‡∏Ç‡∏ß‡∏¥‡πà‡∏á</button>
    </div>

    <!-- ‡∏ä‡πà‡∏≠‡∏á 1 -->
    <div class="label">‡∏ä‡πà‡∏≠‡∏á 1: ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏≠‡∏õ‡πÄ‡∏•‡∏Ç</div>
    <input id="inputNums" type="text" placeholder="‡πÄ‡∏ä‡πà‡∏ô 12 25 ‡∏´‡∏£‡∏∑‡∏≠ 123 456">

    <!-- ‡∏ä‡πà‡∏≠‡∏á 2 -->
    <div class="label">‡∏ä‡πà‡∏≠‡∏á 2: ‡πÄ‡∏•‡∏Ç‡∏•‡πâ‡∏ß‡∏ô (‡∏•‡∏ö‡∏ó‡∏µ‡∏•‡∏∞‡∏ï‡∏±‡∏ß)</div>
    <div id="numbersContainer" class="numbers-container"></div>

    <div class="row">
        <button class="btn-rev" onclick="reverseNumbers()">‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏•‡∏Ç</button>
        <button class="btn-clear" onclick="clearNumbers()">‡∏•‡πâ‡∏≤‡∏á‡πÄ‡∏•‡∏Ç</button>
    </div>

    <div class="row">
        <input id="top" type="number" placeholder="‡∏£‡∏≤‡∏Ñ‡∏≤ ‡∏ö‡∏ô">
        <input id="bottom" type="number" placeholder="‡∏£‡∏≤‡∏Ñ‡∏≤ ‡∏•‡πà‡∏≤‡∏á">
    </div>

    <button id="btnAdd" class="btn-add" onclick="addBillAndReset()">+ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ö‡∏¥‡∏•</button>

    <div class="bill-box" id="billList"></div>
    <div id="totalAll" class="total-all">‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: 0 ‡∏ö‡∏≤‡∏ó</div>

</div>


<script>
let bills = [];
let currentNums = [];
let mode = "2d";

const inputNums = document.getElementById("inputNums");
const numbersContainer = document.getElementById("numbersContainer");
const topPrice = document.getElementById("top");
const bottomPrice = document.getElementById("bottom");

/* ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÇ‡∏´‡∏°‡∏î */
function switchMode(m) {
    mode = m;

    document.querySelectorAll(".mode-btn").forEach(btn =>
        btn.classList.remove("active")
    );
    document.getElementById("btn2d").classList.toggle("active", m === "2d");
    document.getElementById("btn3d").classList.toggle("active", m === "3d");
    document.getElementById("btn19").classList.toggle("active", m === "19");
    document.getElementById("btnRun").classList.toggle("active", m === "run");

    clearNumbers();
    highlightInput();

    bottomPrice.placeholder = (m === "3d") ? "‡∏£‡∏≤‡∏Ñ‡∏≤ ‡πÇ‡∏ï‡πä‡∏î" : "‡∏£‡∏≤‡∏Ñ‡∏≤ ‡∏•‡πà‡∏≤‡∏á";
}

/* ‡πÑ‡∏Æ‡πÑ‡∏•‡∏ï‡πå‡∏ä‡πà‡∏≠‡∏á 1 */
function highlightInput() {
    inputNums.classList.add("highlight");
    setTimeout(() => inputNums.classList.remove("highlight"), 200);
    inputNums.focus();
}

/* ‡πÅ‡∏™‡∏î‡∏á Pill */
function renderNumbers() {
    numbersContainer.innerHTML = "";
    currentNums.forEach((num, index) => {
        const btn = document.createElement("button");
        btn.className = "num-pill";
        btn.textContent = num;
        btn.onclick = () => {
            currentNums.splice(index, 1);
            renderNumbers();
        };
        numbersContainer.appendChild(btn);
    });
}

/* üéØ ‡∏î‡∏∂‡∏á‡πÄ‡∏•‡∏Ç‡∏à‡∏≤‡∏Å‡∏ä‡πà‡∏≠‡∏á 1 (‡πÅ‡∏Å‡πâ‡∏Å‡∏≠‡∏õ‡∏°‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏±‡πà‡∏ß 100%) */
inputNums.addEventListener("input", function () {
    let raw = this.value.trim();

    // ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ space ‚Üí ‡πÅ‡∏¢‡∏Å‡∏ï‡∏£‡∏á‡πÜ
    if (raw.includes(" ")) {
        let parts = raw.split(/\s+/);
        let valid = [];

        parts.forEach(p => {
            let clean = p.replace(/\D/g, "");
            if (mode === "2d" && clean.length === 2) valid.push(clean);
            if (mode === "3d" && clean.length === 3) valid.push(clean);
        });

        if (valid.length > 0) {
            currentNums = currentNums.concat(valid);
            renderNumbers();
            this.value = "";
        }
        return;
    }

    // ‡∏ñ‡πâ‡∏≤‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏≠‡∏á
    let digits = raw.replace(/\D/g, "");
    let chunk = (mode === "3d") ? 3 : 2;

    let newNums = [];
    while (digits.length >= chunk) {
        newNums.push(digits.slice(0, chunk));
        digits = digits.slice(chunk);
    }

    if (newNums.length > 0) {
        currentNums = currentNums.concat(newNums);
        renderNumbers();
    }

    this.value = digits;
});

/* üéØ ‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏•‡∏Ç 3 ‡∏ï‡∏±‡∏ß‡πÅ‡∏ö‡∏ö‡πÑ‡∏°‡πà‡∏ã‡πâ‡∏≥ + ‡πÑ‡∏°‡πà‡∏°‡∏±‡πà‡∏ß + ‡∏ñ‡∏π‡∏Å‡∏Å‡∏ï‡∏¥‡∏Å‡∏≤ */
function reverseNumbers() {
    if (currentNums.length === 0) {
        alert("‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏•‡∏Ç‡πÉ‡∏´‡πâ‡∏Å‡∏•‡∏±‡∏ö");
        return;
    }

    let reversed = [];

    currentNums.forEach(num => {

        // 2 ‡∏ï‡∏±‡∏ß
        if (mode === "2d") {
            reversed.push(num[1] + num[0]);
        }

        // 3 ‡∏ï‡∏±‡∏ß
        if (mode === "3d") {
            let [a,b,c] = num.split("");

            let set = new Set();

            set.add(a+b+c);
            set.add(a+c+b);
            set.add(b+a+c);
            set.add(b+c+a);
            set.add(c+a+b);
            set.add(c+b+a);

            reversed.push(...Array.from(set));
        }
    });

    // ‡∏•‡∏ö‡πÄ‡∏•‡∏Ç‡∏ã‡πâ‡∏≥‡∏≠‡∏≠‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (‡∏ï‡∏±‡∏ß‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏Ç‡∏≠‡∏á‡πÅ‡∏Å)
    let unified = new Set([...currentNums, ...reversed]);

    // ‡πÅ‡∏õ‡∏•‡∏á‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô array
    currentNums = Array.from(unified);

    // ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏à‡∏≤‡∏Å‡∏ô‡πâ‡∏≠‡∏¢‡πÑ‡∏õ‡∏°‡∏≤‡∏Å (‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏ß‡∏¢‡∏á‡∏≤‡∏°)
    currentNums.sort();

    renderNumbers();
}

/* ‡∏•‡πâ‡∏≤‡∏á‡πÄ‡∏•‡∏Ç */
function clearNumbers() {
    currentNums = [];
    renderNumbers();
    topPrice.value = "";
    bottomPrice.value = "";
    inputNums.value = "";
    highlightInput();
}

/* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ö‡∏¥‡∏• */
function addBill() {
    if (currentNums.length === 0) return false;

    const t = Number(topPrice.value || 0);
    const b = Number(bottomPrice.value || 0);

    const count = currentNums.length;
    const total = (count * t) + (count * b);

    bills.push({
        nums:[...currentNums],
        top:t,
        bottom:b,
        total:total,
        mode:mode
    });

    renderBills();
    return true;
}

function addBillAndReset() {
    if (!addBill()) return;
    clearNumbers();
    highlightInput();
}

/* ‡∏•‡∏ö‡∏ö‡∏¥‡∏• */
function delBill(i){
    bills.splice(i,1);
    renderBills();
}

/* UI ‡∏ö‡∏¥‡∏• */
function renderBills() {
    let html = "";
    let totalAll = 0;

    bills.forEach((b, i) => {
        totalAll += b.total;

        html += `
        <div class="bill">
            <div class="bill-left">

                <div class="bill-title">${b.mode === "3d" ? "3 ‡∏ï‡∏±‡∏ß" : "2 ‡∏ï‡∏±‡∏ß"}</div>

                <div class="bill-price">
                    ${b.mode === "3d"
                        ? `‡∏ö‡∏ô √ó ‡∏•‡πà‡∏≤‡∏á √ó ‡πÇ‡∏ï‡πä‡∏î`
                        : `‡∏ö‡∏ô √ó ‡∏•‡πà‡∏≤‡∏á`
                    }
                </div>

                <div class="bill-multiply">
                    ${b.mode === "3d"
                        ? `${b.top} √ó ${b.bottom} √ó ${b.bottom}`
                        : `${b.top} √ó ${b.bottom}`
                    }
                </div>

                <div class="bill-nums">${b.nums.join(" ")}</div>

                <div class="bill-total">
                    ‡∏£‡∏ß‡∏°‡∏ö‡∏¥‡∏•: ${b.total} ‡∏ö‡∏≤‡∏ó
                </div>

            </div>

            <div class="del-btn" onclick="delBill(${i})">üóë</div>
        </div>
        `;
    });

    document.getElementById("billList").innerHTML = html;
    document.getElementById("totalAll").innerText =
        `‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: ${totalAll} ‡∏ö‡∏≤‡∏ó`;
}

/* TAB = ‡∏ö‡∏ô ‚Üí ‡∏•‡πà‡∏≤‡∏á ‚Üí ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ö‡∏¥‡∏• */
document.addEventListener("keydown", function(e){
    if (e.key !== "Tab") return;
    e.preventDefault();

    if (document.activeElement === topPrice) {
        bottomPrice.focus();
        bottomPrice.select();
        return;
    }

    if (document.activeElement === bottomPrice) {
        addBillAndReset();
        return;
    }

    topPrice.focus();
    topPrice.select();
});

/* SPACE = ‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏•‡∏Ç */
document.addEventListener("keydown", function(e){
    if (e.code === "Space") {
        e.preventDefault();
        reverseNumbers();
    }
});
</script>

</body>
</html>
