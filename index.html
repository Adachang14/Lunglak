<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>หวย Simulator</title>

<style>
    body {
        background:#f7d3f2;
        font-family:'Sarabun', sans-serif;
        padding:20px;
    }
    .box {
        width:100%;
        max-width:500px;
        margin:auto;
        background:#fff;
        padding:20px;
        border-radius:15px;
        box-shadow:0 5px 20px rgba(0,0,0,0.15);
    }
    h2 {
        text-align:center;
        color:#c449d5;
        margin-bottom:20px;
    }

    /* โหมด */
    .mode-row {
        display:flex;
        gap:10px;
        margin-bottom:15px;
    }
    .mode-btn {
        background:#ffe9a8;
        border:none;
        padding:10px 18px;
        border-radius:8px;
        cursor:pointer;
        font-weight:bold;
    }
    .mode-btn.active {
        background:#ffb700;
        color:white;
    }

    /* ช่อง 1 */
    input[type="text"] {
        width:100%;
        padding:12px;
        border-radius:10px;
        border:1px solid #aaa;
        font-size:16px;
        box-sizing:border-box;
        transition:0.2s;
    }
    .highlight {
        box-shadow:0 0 10px #ff44c7;
        border-color:#ff44c7 !important;
    }

    /* ช่อง 2 */
    .numbers-container {
        min-height:50px;
        padding:10px;
        border-radius:10px;
        border:1px solid #ddd;
        background:#fffafc;
        display:flex;
        flex-wrap:wrap;
        gap:6px;
        margin-top:4px;
    }
    .num-pill {
        background:#1e6bff;
        color:#fff;
        padding:6px 10px;
        border-radius:8px;
        font-size:15px;
        font-weight:bold;
        border:none;
        cursor:pointer;
    }

    .row { display:flex; gap:10px; margin:10px 0; }

    input[type="number"] {
        width:100%;
        padding:12px;
        border-radius:10px;
        border:1px solid #ccc;
        font-size:16px;
        box-sizing:border-box;
    }

    /* ปุ่ม */
    button {
        padding:12px 16px;
        font-size:16px;
        border-radius:10px;
        border:none;
        cursor:pointer;
        font-weight:bold;
    }
    .btn-rev  { background:#ffe06c; }
    .btn-clear{ background:#ffb3c1; }
    .btn-add  { background:#ff44c7; color:white; }

    /* บิล */
    .bill-box {
        margin-top:20px;
        background:#ffe7f8;
        padding:15px;
        border-radius:15px;
    }
    .bill {
        background:white;
        padding:12px;
        border-radius:12px;
        margin-bottom:12px;
        font-size:17px;
        display:flex;
        justify-content:space-between;
    }
    .del-btn {
        color:red;
        font-size:22px;
        cursor:pointer;
    }
    .total-all {
        text-align:center;
        font-size:22px;
        margin-top:20px;
        font-weight:bold;
    }

    .label {
        font-size:14px;
        margin:5px 0 3px;
        color:#555;
    }
</style>
</head>

<body>

<div class="box">

    <h2>หวย Simulator Demo</h2>

    <!-- ปุ่มโหมด -->
    <div class="mode-row">
        <button class="mode-btn active" id="btn2d" onclick="switchMode('2d')">2 ตัว</button>
        <button class="mode-btn" id="btn3d" onclick="switchMode('3d')">3 ตัว</button>
        <button class="mode-btn" id="btn19" onclick="switchMode('19')">19 ประตู</button>
        <button class="mode-btn" id="btnRun" onclick="switchMode('run')">เลขวิ่ง</button>
    </div>

    <div class="label">ช่อง 1: พิมพ์หรือกอปเลข</div>
    <input id="inputNums" type="text" placeholder="เช่น 12 25 หรือ 123 456">

    <div class="label">ช่อง 2: เลขล้วน (ลบทีละตัว)</div>
    <div id="numbersContainer" class="numbers-container"></div>

    <div class="row">
        <button class="btn-rev" onclick="reverseNumbers()">กลับเลข</button>
        <button class="btn-clear" onclick="clearNumbers()">ล้างเลข</button>
    </div>

    <div class="row">
        <input id="top" type="number" placeholder="ราคา บน">
        <input id="bottom" type="number" placeholder="ราคา ล่าง">
    </div>

    <button id="btnAdd" class="btn-add" onclick="addBillAndReset()">+ เพิ่มบิล</button>

    <div class="bill-box" id="billList"></div>
    <div id="totalAll" class="total-all">รวมทั้งหมด: 0 บาท</div>

</div>


<script>
let bills = [];
let currentNums = [];
let mode = "2d"; // 2d = 2 ตัว, 3d = 3 ตัว

const inputNums = document.getElementById("inputNums");
const numbersContainer = document.getElementById("numbersContainer");
const topPrice = document.getElementById("top");
const bottomPrice = document.getElementById("bottom");

/* ============================================================
   โหมด
   ============================================================ */
function switchMode(m) {
    mode = m;

    document.querySelectorAll(".mode-btn").forEach(btn => btn.classList.remove("active"));
    document.getElementById("btn2d").classList.toggle("active", m === "2d");
    document.getElementById("btn3d").classList.toggle("active", m === "3d");
    document.getElementById("btn19").classList.toggle("active", m === "19");
    document.getElementById("btnRun").classList.toggle("active", m === "run");

    clearNumbers();
    highlightInput();

    if (m === "3d") {
        topPrice.placeholder = "ราคา บน";
        bottomPrice.placeholder = "ราคา โต๊ด";
    } else {
        topPrice.placeholder = "ราคา บน";
        bottomPrice.placeholder = "ราคา ล่าง";
    }
}

/* ไฮไลต์ช่อง 1 */
function highlightInput() {
    inputNums.classList.add("highlight");
    setTimeout(() => inputNums.classList.remove("highlight"), 200);
    inputNums.focus();
}

/* ============================================================
   แสดงเลข pill
   ============================================================ */
function renderNumbers() {
    numbersContainer.innerHTML = "";
    currentNums.forEach((num, index) => {
        const btn = document.createElement("button");
        btn.className = "num-pill";
        btn.textContent = num;
        btn.onclick = () => {
            currentNums.splice(index, 1);
            renderNumbers();
        };
        numbersContainer.appendChild(btn);
    });
}

/* ============================================================
   รับเลขช่อง 1 → ตัด 2 หรือ 3 หลัก
   ============================================================ */
inputNums.addEventListener("input", function () {
    let raw = this.value;
    let digits = raw.replace(/\D/g, "");

    let chunk = mode === "3d" ? 3 : 2;

    let newNums = [];
    while (digits.length >= chunk) {
        newNums.push(digits.slice(0, chunk));
        digits = digits.slice(chunk);
    }

    if (newNums.length > 0) {
        currentNums = currentNums.concat(newNums);
        renderNumbers();
    }

    this.value = digits;
});

/* ============================================================
   กลับเลข
   ============================================================ */
function reverseNumbers() {
    if (currentNums.length === 0) return alert("ไม่มีเลขให้กลับ");

    let reversed = [];

    if (mode === "2d") {
        reversed = currentNums.map(n => n[1] + n[0]);
    } 
    else if (mode === "3d") {
        currentNums.forEach(num => {
            if (num.length === 3) {
                const [a, b, c] = num;
                reversed.push(a+b+c, a+c+b, b+a+c, b+c+a, c+a+b, c+b+a);
            }
        });
    } 
    else {
        alert("โหมดนี้ยังไม่เปิดใช้งาน");
        return;
    }

    currentNums = currentNums.concat(reversed);
    renderNumbers();
}

/* ============================================================
   ล้างเลข
   ============================================================ */
function clearNumbers() {
    currentNums = [];
    renderNumbers();

    topPrice.value = "";
    bottomPrice.value = "";
    inputNums.value = "";

    highlightInput();
}

/* ============================================================
   เพิ่มบิล
   ============================================================ */
function addBill() {
    if (currentNums.length === 0) return false;

    const t = Number(topPrice.value || 0);
    const b = Number(bottomPrice.value || 0);

    const count = currentNums.length;
    const total = (count * t) + (count * b);

    bills.push({
        nums:[...currentNums],
        top:t,
        bottom:b,
        total:total,
        mode:mode
    });

    renderBills();
    return true;
}

/* เพิ่มบิล + reset */
function addBillAndReset() {
    if (!addBill()) return;
    clearNumbers();
    highlightInput();
}

/* ============================================================
   ลบบิล
   ============================================================ */
function delBill(i){
    bills.splice(i,1);
    renderBills();
}

/* ============================================================
   แสดงบิล
   ============================================================ */
function renderBills() {
    let html = "";
    let totalAll = 0;

    bills.forEach((b,i)=>{
        totalAll += b.total;

        html += `
        <div class="bill">
            <div>
                ${b.mode === "3d" ? "<b>[3 ตัว]</b>" : "<b>[2 ตัว]</b>"}<br>
                ${b.nums.join(" ")}<br>
                บน ${b.top} × ${b.nums.length} = ${b.top * b.nums.length}<br>
                ${b.mode === "3d"
                    ? `โต๊ด ${b.bottom} × ${b.nums.length} = ${b.bottom * b.nums.length}`
                    : `ล่าง ${b.bottom} × ${b.nums.length} = ${b.bottom * b.nums.length}`
                }<br>
                <b>รวมบิล: ${b.total} บาท</b>
            </div>
            <div class="del-btn" onclick="delBill(${i})">×</div>
        </div>
        `;
    });

    document.getElementById("billList").innerHTML = html;
    document.getElementById("totalAll").innerText =
        `รวมทั้งหมด: ${totalAll} บาท`;
}

/* ============================================================
   TAB = บน → ล่าง → เพิ่มบิล
   ============================================================ */
document.addEventListener("keydown", function(e){
    if (e.key !== "Tab") return;
    e.preventDefault();

    const active = document.activeElement;

    if (active === topPrice) {
        bottomPrice.focus();
        bottomPrice.select();
        return;
    }

    if (active === bottomPrice) {
        addBillAndReset();
        return;
    }

    topPrice.focus();
    topPrice.select();
});

/* Space = กลับเลข */
document.addEventListener("keydown", function(e){
    if (e.code === "Space") {
        e.preventDefault();
        reverseNumbers();
    }
});
</script>

</body>
</html>
